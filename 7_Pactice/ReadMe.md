**Ответы на контрольные вопросы:**

**1. В чём разница между редукцией и сканированием?**

Редукция сводит весь массив к одному итоговому значению, например сумме или максимуму, тогда как сканирование вычисляет префиксные результаты для каждого элемента массива. В первом случае результат — скаляр, во втором — массив той же длины, где каждый элемент зависит от всех предыдущих.

**2. Какие типы памяти CUDA используются для оптимизации редукции и сканирования?**

Для ускорения чаще всего используют shared memory, так как она позволяет потокам внутри блока быстро обмениваться данными, и регистры для временных значений. Глобальная память применяется для хранения исходных данных и результатов, но обращения к ней стараются минимизировать и делать согласованными. В отдельных случаях дополнительно используют constant memory или кэш только для чтения.

**3. Как можно оптимизировать префиксную сумму на GPU?**

Префиксную сумму оптимизируют с помощью иерархического подхода: сначала scan выполняется внутри каждого блока в shared memory, затем считается scan по массиву сумм блоков, и после этого к элементам каждого блока добавляется соответствующее смещение. Дополнительно производительность повышают за счёт согласованных обращений к памяти, уменьшения числа синхронизаций и использования операций на уровне варпа.

**4. Приведите пример задачи, где применяется сканирование.**

Сканирование широко используется в задаче уплотнения массива (stream compaction), когда нужно удалить элементы по условию. С его помощью вычисляются позиции элементов в выходном массиве. Также scan применяется в сортировках, построении индексов разреженных структур и при обработке гистограмм.
